---
title: 浏览器接口笔记
author: AshGrey
date: 2024-04-09 00:00:00 +0800
categories: [Coumputer Science, Language]
tags: [Computer Science, JavaScript]
---

> 本文章所属领域：
>
> [实践产业知识 - 工业产业 - 计算机科学 - 编程语言 - JavaScript]({% post_url /Computer Science/2024-02-08-计算机科学：索引笔记 %})
{: .prompt-info}

<br>

## 1 文档

<br>

### 1.1 DOM 树、遍历、搜索

<br>

对于一个 HTML 文档，例如

<br>

``` HTML
<!DOCTYPE HTML>
<html>
  <head>
    <title>About AshGrey</title>
  </head>
  <body>
    <p>The Secrets About AshGrey</p>
    <ol>
      <li>He loves Izumi Sagiri</li>
      <!-- It's not a secret -->
      <li>He is a lolicon</li>
    </ol>
  </body>
</html>
```

<br>

以上 HTML 文档将被浏览器生成为以下的 DOM，其中注释本身也会成为一个 DOM 节点（常用的节点类型有四种，`document`、元素节点、文本节点和注释）：

<br>

``` plaintext
- DOCTYPE-HTML
- HTML
  - HEAD
  - BODY
    - P
      #text The Secrets About AshGrey
    - OL
      - LI
        #text He loves Izumi Sagiri
      #comment It's not a secret
      - LI
        #text He is a lolicon
```

<br>

最顶层的`document`节点是`document.documentElement`，对应`<html>`标签的 DOM 节点；`<body>`的 DOM 节点对应的是 `document.body`；`<head>`标签对应的是`document.head`。

<br>

注意脚本无法访问在运行时不存在的元素，如果一个脚本在`<head>`中，那么脚本无法访问到`document.body`元素，获取这个节点会返回`null`，可以使用`.hasChildNodes()`函数检验一个节点下是否还有其他节点。可以使用`childNodes`访问子节点：

<br>

``` javascript
for (let i = 0; i <= document.body.childNodes.length; i++) {
    alert(document.body.childNodes[i]);
}
```

<br>

`childNodes`实际是一个集合而不是数组，集合是一个类似于数组的可迭代对象，可以使用`for-of`来迭代它，但是不能使用数组的方法，如果想使用数组的方法，需要使用`Array.from`方法从集合创建一个数组。以下是 DOM 集合的一些特点：
- DOM 集合是只读的，不能使用`childNodes[i]=`这样的操作替换一个子节点。修改子节点需要使用其他方法；
- DOM 集合是实时的，它们反映了 DOM 的当前状态，对 DOM 添加或者移除节点，那么这些节点的更新会自动出现在集合中；
- 不能使用`for-in`迭代集合，`for-in`循环遍历的是所有可枚举的属性，集合还有一些很少被使用的属性，这些属性是我们不希望得到的。

<br>

第一个子节点在`firstChild`属性中，最后一个子节点在`lastChild`属性中。同级节点（兄弟节点）是指由同一个父节点的节点，下一个同级节点在`nextSibling`属性中，上一个同级节点在`previousSibling`属性中。父节点可以在`parentNode`属性中访问。

<br>

上述的导航属性引用所有的节点，在`childNodes`中可以看到文本节点、元素节点和注释节点，有很多节点我们并不需要，我们需要的是代表标签和形成页面结构的元素节点，此时我们可以只考虑元素节点的导航链接：
- `children`：仅那些作为元素节点的子代的节点；
- `firstElementChild`，`lastElementChild`：第一个和最后一个子元素；
- `previousElementSibling`，`nextElementSibling`：同级元素；
- `parentElement`：父元素。

<br>

以上是遍历 DOM 和获取相近的 DOM 元素的方法，如果在一个特别复杂的 DOM 中确定一个元素节点，需要使用一些搜索的方法。
- 如果一个元素由`id`属性，则可以使用`document.getElementById(id)`方法来获取该元素。同时这也要求了`id`必须是唯一的，在文档中只能有一个元素带有给定的`id`，如果有多个元素都带有同一个`id`，那么使用它的方法的行为是不可预测的；

    ``` HTML
    <!DOCTYPE html>
    <html>
    <head>
      <title>Test HTML Document</title>
    </head>
    <body>
      <ul>
        <li>Choice 1</li>
        <li>Choice 2</li>
        <li>Choice 3</li>
      </ul>
      <div id="End">End</div>
      <p>I love Izumi Sagiri</p>
      <ol>
        <li>Izumi Sagiri</li>
        <li>Elaina</li>
      </ol>
      <script>
        let divText = document.getElementById('End');
        divText.style.background = 'red';
      </script>
    </body>
    </html>
    ```

- 到目前为止，最通用的搜索元素节点的方法是`.querySelectorAll(css)`方法，它返回给定 CSS 选择器匹配的所有元素，